<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="description" content="">
  <meta name="author" content="Jakub Stejskal">

  <title>NaLIDa - a natural language interface for database</title>

  <link href="webjars/bootstrap/3.1.1/css/bootstrap.min.css" rel="stylesheet">
  <link href="nalida.css" rel="stylesheet">

  <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
      <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
      <![endif]-->
    </head>

    <body>

      <div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
        <div class="container">
          <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
              <span class="sr-only">Toggle navigation</span>
              <span class="icon-bar"></span>
              <span class="icon-bar"></span>
              <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="#">NaLIDa</a>
          </div>
          <div class="collapse navbar-collapse">
            <ul class="nav navbar-nav">
              <li class="active"><a href="#">Home</a></li>
              <li><a href="#kosapi">KOSapi response</a></li>
              <li><a href="#sql">SQL query</a></li>
              <li><a href="#debug">Detailed log</a></li>
              <li><a href="#apidesc">API</a></li>
              <li><a href="https://github.com/jakub-stejskal/nalida-web">GitHub</a></li>
            </ul>
          </div><!--/.nav-collapse -->
        </div>
      </div>

      <div class="container">

        <div class="starter-template">
        <div class="page-header">
          <h1>Welcome to NaLIDa <small>a Natural Language Interface for Database</small></h1>
          </div>
          <p class="lead">
            Ask a question from the domain of KOS, information system of CTU in Prague.
            NaLIDa knows stuff about students, teachers, divisions, courses, parallels and exams.
          </p>
          <p class="lead">
            Check the <a href="api/kos/schema">enumeration of supported entities, attributes
            and their natural language tokens</a> in XML format for inspiration.
            Click on the examples or submit your own natural language question in English. Use either a wh-question or a noun phrase.
          </p>


            <div class="row">
                <div class="col-md-4">
            <h3 id="kosapi">KOSapi response</h3>
            <form name="input" action="api/kos" method="get">
            <div class="input-group">
              <input class="form-control" type="text" name="q">
              <span class="input-group-btn">
                <input class="btn btn-primary" type="submit" value="Submit">
              </span>
            </div>
            <label><input type="checkbox" name="t" value="-1"> auto-disambiguate</label>
            </form>
            <h4>Examples</h4>
            <div class="list-group">
              <a data-toggle="modal" data-target="#myModal" class="list-group-item" href="api/kos/?t=-1&q=What%20is%20phone%20of%20Jan%20%C5%A0ediv%C3%BD?">What is phone of Jan Šedivý?</a>
              <a data-toggle="modal" data-target="#myModal" class="list-group-item" href="api/kos/?t=-1&q=Which%20teachers%20are%20from%20division%2013133?">Which teachers are from division 13133?</a>
            </div>
            </div>

            <div class="col-md-4">
            <h3 id="sql">SQL query</h3>
            <form name="input" action="api/kos/sql" method="get">
            <div class="input-group">
		      <input class="form-control" type="text" name="q">
		      <span class="input-group-btn">
		        <input class="btn btn-primary" type="submit" value="Submit">
		      </span>
		    </div>
            <label><input type="checkbox" name="t" value="-1"> auto-disambiguate</label>
            </form>
            <h4>Examples</h4>
            <div class="list-group">
              <a data-toggle="modal" data-target="#myModal" class="list-group-item" href="api/kos/sql?t=-1&q=What%20is%20phone%20of%20Jan%20%C5%A0ediv%C3%BD?">What is phone of Jan Šedivý?</a>
              <a data-toggle="modal" data-target="#myModal" class="list-group-item" href="api/kos/sql?t=-1&q=Which%20teachers%20are%20from%20division%2013133?">Which teachers are from division 13133?</a>
            </div >
            </div>

            <div class="col-md-4">
            <h3 id="debug">Detailed log</h3>
            <form name="input" action="api/kos/debug" method="get">
            <div class="input-group">
              <input class="form-control" type="text" name="q">
              <span class="input-group-btn">
                <input class="btn btn-primary" type="submit" value="Submit">
              </span>
            </div>
            <label><input type="checkbox" name="t" value="-1"> auto-disambiguate</label>
            </form>
            <h4>Examples</h4>
            <div class="list-group">
              <a data-toggle="modal" data-target="#myModal" class="list-group-item" href="api/kos/debug?t=-1&q=What%20is%20phone%20of%20Jan%20%C5%A0ediv%C3%BD?">What is phone of Jan Šedivý?</a>
              <a data-toggle="modal" data-target="#myModal" class="list-group-item" href="api/kos/debug?t=-1&q=Which%20teachers%20are%20from%20division%2013133?">Which teachers are from division 13133?</a>
            </div>
            </div>
          </div><!-- row -->

          <div class="row">
          <h2 id="apidesc">API description</h2>
            <h3>KOSapi response</h3>
            <p>The KOSapi response resource retrieves the result data corresponding to the submitted
            query by generating and executing a RSQL query plan.</p>
            <dl>
            <dt>resource URI</dt> <dd><pre>GET /api/kos?q=&lt;query&gt;&t=&lt;interpretationId&gt;</pre></dd>
            <dt>query parameters</dt>
              <dd><dl>
                <dt>query (q)</dt>                <dd>- required parameter, contains the natural language query to be translated.</dd>
                <dt>interpretationId (t)</dt>     <dd>- optional parameter, identifies the selected interpretation in the case that the query is ambiguous. Value -1 means that the ambiguity should be resolved automatically.</dd>
              </dl></dd>
            <dt>produces</dt> <dd>application/xml, text/html</dd>
            <dt>responses</dt>
              <dd><dl>
                <dt>200 OK</dt>                   <dd>- query was successfully translated. The response contains either the result data or a list of possible interpretations in the case of ambiguity.</dd>
                <dt>400 Bad request</dt>          <dd>- no query was submitted or it was not translatable.</dd>
                <dt>500 Internal server error</dt><dd>- communication with KOSapi failed.</dd>
              </dl></dd>
            </dl>

            <h3>SQL query</h3>
            <p>The SQL query resource translates the submitted query into a SQL query plan.</p>
            <dl>
            <dt>resource URI</dt> <dd><pre>GET /api/kos/sql?q=&lt;query&gt;&t=&lt;interpretationId&gt;</pre></dd>
            <dt>query parameters</dt>
              <dd><dl>
                <dt>query (q)</dt>                <dd>- required parameter, contains the natural language query to be translated.</dd>
                <dt>interpretationId (t)</dt>     <dd>- optional parameter, identifies the selected interpretation in the case that the query is ambiguous. Value -1 means that the ambiguity should be resolved automatically.</dd>
              </dl></dd>
            <dt>produces</dt> <dd>application/xml, text/html</dd>
            <dt>responses</dt>
              <dd><dl>
                <dt>200 OK</dt>                   <dd>- query was successfully translated. The response contains a translation to SQL statement instead of the result data.</dd>
                <dt>400 Bad request</dt>          <dd>- no query was submitted or it was not translatable.</dd>
                <dt>500 Internal server error</dt><dd>- communication with KOSapi failed.</dd>
              </dl></dd>
            </dl>

            <h3>Detailed intermediate outputs</h3>
            <p>The detailed intermediate outputs resource provides a textual debugging log concerning
              RSQL and SQL query plan generation, along with intermediate results and the final
              XML result.</p>
            <dl>
            <dt>resource URI</dt> <dd><pre>GET /api/kos/debug?q=&lt;query&gt;&t=&lt;interpretationId&gt;</pre></dd>
            <dt>query parameters</dt>
              <dd><dl>
                <dt>query (q)</dt>                <dd>- required parameter, contains the natural language query to be translated.</dd>
                <dt>interpretationId (t)</dt>     <dd>- optional parameter, identifies the selected interpretation in the case that the query is ambiguous. Value -1 means that the ambiguity should be resolved automatically.</dd>
              </dl></dd>
            <dt>produces</dt> <dd>text/plain, text/html</dd>
            <dt>responses</dt>
              <dd><dl>
                <dt>200 OK</dt>                   <dd>- query was successfully translated. The response contains a text document with
                  debug information including the submitted query, the selected interpretation, the
                  translation to both RSQL and SQL query plans and the result data.</dd>
                <dt>400 Bad request</dt>          <dd>- no query was submitted or it was not translatable.</dd>
                <dt>500 Internal server error</dt><dd>- communication with KOSapi failed.</dd>
              </dl></dd>
            </dl>


          </div>
          </div>
        </div><!-- /.container -->

        <!-- Modal -->
		<div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
		  <div class="modal-dialog">
		    <div class="modal-content">
		      <div class="modal-header">
		        <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
		        <h4 class="modal-title" id="myModalLabel">Loading</h4>
		      </div>
		      <div class="modal-body">
		        <textarea disabled>...</textarea>
		      </div>
		    </div><!-- /.modal-content -->
		  </div><!-- /.modal-dialog -->
		</div><!-- /.modal -->

    <script src="webjars/jquery/1.11.0/jquery.min.js"></script>
    <script src="webjars/bootstrap/3.1.1/js/bootstrap.min.js"></script>
    <script>

    $('#myModal').on('show.bs.modal', function (e) {
        $('.modal-content textarea').css('height',$( window ).height()*0.7);
        });
    $('#myModal').on('loaded.bs.modal', function (e) {
    	$('.modal-content textarea').css('height',$( window ).height()*0.7);
    	});

    $('body').on('hidden.bs.modal', '.modal', function () {
    	  $(this).removeData('bs.modal');
    	});

    $('form').submit(function (e) {
        e.preventDefault();
        console.log(e.target.action + "?" + $(e.target).serialize());

        $("#myModal").modal({
            remote : e.target.action + "?" + $(e.target).serialize()
        });
    });
    </script>
  </body>
  </html>
